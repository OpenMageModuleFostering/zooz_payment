<?php

if ($this->getResult()) {
    $response = array();
    foreach ($this->getResult() as $code => $_rates) {

        $arr = array();
        foreach ($_rates as $_rate) {
            if (!$_rate->getErrorMessage()) {
                $rate_name = $_rate->getMethodTitle();
                $arr[] = array('name' => $rate_name, 'price' => $_rate->getPrice());
            }
        }
        $response[] = array('carrierName' => $this->getCarrierName($code),'carrierCode' => $code, 'rates' => $arr);
    }
	if(count($arr) == 0)
	{
		$result[] = array('error'=>true,'message'=>'There is no shipping method available for this address.');
		echo json_encode($result);
	}
	else { echo json_encode($response); }
	
}
?>
